<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>ЛР4 Задание 3</title>

        <meta charset="utf-8"> <!-- для корректного вывода русского языка -->

        <script type="text/javascript">
            /*
            Для задач прогаммного моделирования стека и циклической очереди оформить в виде функций:
            добавление элемента в стек
            извлечение элемента из стека
            добавление элемента в очередь
            извлечение элемента из очереди
            */

            var stack = {
                data: new Array,
                length: 0,
                maxsize: 1,

                pop() {
                    if (this.length > 0) {
                        let item = this.data.pop();
                        this.length--;
                        return item;
                    }
                    return "Пусто";
                }
            }

            var queue = {
                data: new Array,
                length: 0,
                maxsize: 1,

                shift() {
                    if (this.length > 0) {
                        let item = this.data.shift();
                        this.length--;
                        return item;
                    }
                    return "Пусто";
                }
            }

            function push(item) { //одинаковая для стека и очереди, поэтому отдельно
                if (this.length < this.maxsize) {
                    this.data.push(item);
                    this.length++;
                    return 1;
                }
                return 0;
            }

            stack.push = queue.push = push;

            var choice = prompt("Вы давно не разбирали свою личную библиотеку и решаете, чем займётесь сейчас:" + "\n\n 1 - составить башню из книг (стек)" + "\n 2 - расставить книги на полке (очередь)", 1);

            if (choice != 1 && choice != 2) alert("Вы передумали разбираться с книгами. В конце концов, можно этим заняться и завтра.");

            else {
                var size = parseInt(prompt("С каким максимальным количеством книг вы собираетесь работать?", 2));

                if (size <= 0) alert("Вы передумали разбираться с книгами. В конце концов, можно этим заняться и завтра.");

                else {
                    stack.maxsize = queue.maxsize = size;
                    var book;
                    
                    do {
                        if (choice == 1) {
                            do {
                                choice = parseInt(prompt("Вы решили, что будете работать с башней (стек) максимум из " + size + " книг(и)." + "\nТекущая башня: " + stack.data + ". Размер башни: " + stack.length + "\n\nДля работы с башней доступны следующие команды: " + "\n 1 - добавить книгу в башню;" + "\n 2 - забрать книгу из башни;" + "\n 3 - переключиться на работу с полкой (очередь);" + "\n 0 - завершить работу: "));
                                
                                switch(choice) {
                                    case 1:
                                        book = prompt("Вы решили положить книгу в башню." + "\n\nВведите название книги, которую хотите положить в башню: ", "Книга " + Math.floor(Math.random() * 100));
                                        if (stack.push(book) == 1)  alert("Вы аккуратно кладёте книгу с названием \"" + book + "\" в башню.");
                                        else alert("Вы решили положить книгу в башню." + "\nК сожалению, ваша башня уже слишком высокая, и вы откладываете книгу в сторону.");
                                        break;
                                    case 2:
                                        book = stack.pop();
                                        if (book != "Пусто") alert("Вы решили забрать книгу с башни." + "\nСамая верхняя книга - \"" + book + "\". Вы снимаете её с башни и откладываете в сторону.");
                                        else alert("Вы решили забрать книгу с башни." + "\nК сожалению (или к радости) вы уже разобрали всю башню и в ней не осталось книг.");
                                        break;
                                    default:
                                        break;
                                }
                            }
                            while (choice != 3 && choice != 0);
                        }

                        else {
                            do {
                                choice = parseInt(prompt("Вы решили, что будете работать с полкой (очередь) максимум из " + size + " книг(и)." + "\nТекущая полка: " + queue.data + ". Размер полки: " + queue.length + "\n\nДля работы с полкой доступны следующие команды: " + "\n 1 - добавить книгу на полку;" + "\n 2 - забрать книгу с полки;" + "\n 3 - переключиться на работу с башней (стек);" + "\n 0 - завершить работу: "));
                                
                                switch(choice) {
                                    case 1:
                                        book = prompt("Вы решили поставить книгу на полку." + "\n\nВведите название книги, которую хотите поставить на полу: ", "Книга " + Math.floor(Math.random() * 100));
                                        if (queue.push(book) == 1) alert("Вы аккуратно ставите книгу с названием \"" + book + "\" на полку.");
                                        else alert("Вы решили поставить книгу на полку." + "\nК сожалению, лимит книг на полке уже достигнут, и вы откладываете книгу в сторону.");

                                        break;
                                    case 2:
                                        book = queue.shift();
                                        if (book != "Пусто") alert("Самая первая книга - \"" + book + "\". Вы снимаете её с полки и откладываете в сторону.");
                                        else alert("К сожалению (или к радости) вы уже разобрали всю полку и в ней не осталось книг.");

                                        break;
                                    default:
                                        break;
                                }
                            }
                            while (choice != 3 && choice != 0);
                            if (choice == 3) choice = 1; // переключатель с очереди на стек
                        }
                    }
                    while (choice != 0);
                }
                alert("Вы решили, что достаточно потрудились на сегодня, и отправились отдыхать.");
            }
        </script>
    </head>
    <body>
    </body>
</html>